library(HMDHFDplus)
library(reshape2)
setwd("C:/Users/jmaburto.SAM/Documents/GitHub/Formal-demography-course-PRIVATE/Day 1/R/Kitagawa in R/")
XYZ <- 'ISL'
us <- "jmaburto@colmex.mx" # write your username
pw <- "kolmogorov" # write your password
Deaths    <- readHMDweb(XYZ,"Deaths_1x1",username=us,password=pw)
Exposures <- readHMDweb(XYZ,"Exposures_1x1",username=us,password=pw)
unique(Deaths$Year)
years     <- c(1990,2016)
Deaths    <- Deaths[Deaths$Year %in% years,]
Exposures <- Exposures[Exposures$Year %in% years,]
save(Deaths,Exposures,file = 'Kitagawa_Data.RData')
Dx1 <- Deaths[Deaths$Year == 1990]$Total
Dx1 <- Deaths[Deaths$Year == 1990,]$Total
Dx1
Nx1 <- Exposures[Exposures$Year == 1990,]$Total
Nx1
Mx1 <- Dx1/Nx1
Mx1
Mx1[is.na(Mx1)]
Mx1[is.na(Mx1)] <- 0
CDR1 <- sum(Dx1)/sum(Nx1)
CDR1
CDR1*1000
Dx2 <- Deaths[Deaths$Year == 2016,]$Total
Nx2 <- Exposures[Exposures$Year == 2016,]$Total
Mx2 <- Dx2/Nx2
Mx2[is.na(Mx2)] <- 0
CDR2 <- sum(Dx2)/sum(Nx2)
CDR2*1000
Dx2 <- Deaths[Deaths$Year == 2016,]$Total
Nx2 <- Exposures[Exposures$Year == 2016,]$Total
Mx2 <- Dx2/Nx2
Mx2[is.na(Mx2)] <- 0
CDR2 <- sum(Dx2)/sum(Nx2)
CDR1*1000
CDR2*1000
(CDR2 - CDR1)*1000
RC <- sum(0.5*(Nx2/sum(Nx2) + Nx1/sum(Nx1))*(Mx2-Mx1))
RC*1000
CC <- sum(0.5*(Mx2+Mx1)*(Nx2/sum(Nx2)-Nx1/sum(Nx1)))
CC*1000
RC*1000 + CC*1000
CDR2*1000
(CDR2 - CDR1)*1000
library(HMDHFDplus)
library(reshape2)
setwd("C:/Users/jmaburto.SAM/Documents/GitHub/Formal-demography-course-PRIVATE/Day 1/R/Kitagawa in R/")
#choose a Country from HMD
XYZ <- 'ISL'
us <- "jmaburto@colmex.mx" # write your username
pw <- "kolmogorov" # write your password
# now grab death counts and population
Deaths    <- readHMDweb(XYZ,"Deaths_1x1",username=us,password=pw)
Exposures <- readHMDweb(XYZ,"Exposures_1x1",username=us,password=pw)
# select some years
unique(Deaths$Year)
years     <- c(1990,2016)
Deaths    <- Deaths[Deaths$Year %in% years,]
Exposures <- Exposures[Exposures$Year %in% years,]
save(Deaths,Exposures,file = 'Kitagawa_Data.RData')
# time period 1
# Select deaths for first period
Dx1 <- Deaths[Deaths$Year == 1990,]$Total
# Select population for first period
Nx1 <- Exposures[Exposures$Year == 1990,]$Total
# get age-specific mortality rates
Mx1 <- Dx1/Nx1
# replace NA's with zero (just for simplicity)
Mx1[is.na(Mx1)] <- 0
# get the crude death rate in time 1
CDR1 <- sum(Dx1)/sum(Nx1)
#crude death expressed by 1000 in time 1
CDR1*1000
# Do the same for period 2
Dx2 <- Deaths[Deaths$Year == 2016,]$Total
Nx2 <- Exposures[Exposures$Year == 2016,]$Total
Mx2 <- Dx2/Nx2
Mx2[is.na(Mx2)] <- 0
CDR2 <- sum(Dx2)/sum(Nx2)
#crude death expressed by 1000 in time 1
CDR2*1000
#change in CDR
(CDR2 - CDR1)*1000
# wHAT WOULD HAVE EXPECTED
RC <- sum(0.5*(Nx2/sum(Nx2) + Nx1/sum(Nx1))*(Mx2-Mx1))
RC*1000
CC <- sum(0.5*(Mx2+Mx1)*(Nx2/sum(Nx2)-Nx1/sum(Nx1)))
CC*1000
RC*1000 + CC*1000
library(data.table)
load('Data_Exercise_1.RData')
load('Kitagawa_Data.RData')
load('Kitagawa_Data.RData')
# time period 1
# Select deaths for first period
Dx1 <- Deaths[Deaths$Year == 1990,]$Total
# Select population for first period
Nx1 <- Exposures[Exposures$Year == 1990,]$Total
# Do the same for period 2
Dx2 <- Deaths[Deaths$Year == 2016,]$Total
Nx2 <- Exposures[Exposures$Year == 2016,]$Total
# get age-specific mortality rates
Mx1 <- Dx1/Nx1
# replace NA's with zero (just for simplicity)
Mx1[is.na(Mx1)] <- 0
# dot the same for the second period
Mx2 <- Dx2/Nx2
Mx2[is.na(Mx2)] <- 0
# get the crude death rate in time 1
CDR1 <- sum(Dx1)/sum(Nx1)
#crude death expressed by 1000 in time 1
CDR1*1000
# the same for period 2
CDR2 <- sum(Dx2)/sum(Nx2)
#crude death expressed by 1000 in time 2
CDR2*1000
#change in CDR
(CDR2 - CDR1)*1000
RC <- sum(0.5*(Nx2/sum(Nx2) + Nx1/sum(Nx1))*(Mx2-Mx1))
RC*1000
CC <- sum(0.5*(Mx2+Mx1)*(Nx2/sum(Nx2)-Nx1/sum(Nx1)))
CC*1000
RC*1000 + CC*1000
Dif <- (CDR2 - CDR1)*1000
Dif
